!function(t,e){"use strict";"function"==typeof define&&define.amd?define("tinysort",function(){return e}):t.tinysort=e}(this,function(){"use strict";function t(t,e){for(var r,a=t.length,o=a;o--;)r=a-o-1,e(t[r],r)}function e(t,e,r){for(var o in e)(r||t[o]===a)&&(t[o]=e[o]);return t}function r(t,e,r){u.push({prepare:t,sort:e,sortBy:r})}var a,o=!1,n=null,s=window,i=s.document,d=parseFloat,l=/(-?\d+\.?\d*)\s*$/g,c=/(\d+\.?\d*)\s*$/g,u=[],f=0,h=0,p=String.fromCharCode(4095),v={selector:n,order:"asc",attr:n,data:n,useVal:o,place:"org",returns:o,cases:o,natural:o,forceStrings:o,ignoreDashes:o,sortFunction:n,useFlex:o,emptyEnd:o};return s.Element&&function(t){t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,r=(e.parentNode||e.document).querySelectorAll(t),a=-1;r[++a]&&r[a]!=e;);return!!r[a]}}(Element.prototype),e(r,{loop:t}),e(function(r,s){function m(t){var r=!!t.selector,a=r&&":"===t.selector[0],o=e(t||{},v);k.push(e({hasSelector:r,hasAttr:!(o.attr===n||""===o.attr),hasData:o.data!==n,hasFilter:a,sortReturnNumber:"asc"===o.order?1:-1},o))}function g(t,e,r){for(var a=r(t.toString()),o=r(e.toString()),n=0;a[n]&&o[n];n++)if(a[n]!==o[n]){var s=Number(a[n]),i=Number(o[n]);return s==a[n]&&i==o[n]?s-i:a[n]>o[n]?1:-1}return a.length-o.length}function b(t){for(var e,r,a=[],o=0,n=-1,s=0;e=(r=t.charAt(o++)).charCodeAt(0);){var i=46==e||e>=48&&57>=e;i!==s&&(a[++n]="",s=i),a[n]+=r}return a}function w(){return q.forEach(function(t){E.appendChild(t.elm)}),E}function y(t){var e=t.elm,r=i.createElement("div");return t.ghost=r,e.parentNode.insertBefore(r,e),t}function S(t,e){var r=t.ghost,a=r.parentNode;a.insertBefore(e,r),a.removeChild(r),delete t.ghost}function x(t,e){var r,a=t.elm;return e.selector&&(e.hasFilter?a.matchesSelector(e.selector)||(a=n):a=a.querySelector(e.selector)),e.hasAttr?r=a.getAttribute(e.attr):e.useVal?r=a.value||a.getAttribute("value"):e.hasData?r=a.getAttribute("data-"+e.data):a&&(r=a.textContent),C(r)&&(e.cases||(r=r.toLowerCase()),r=r.replace(/\s+/g," ")),null===r&&(r=p),r}function C(t){return"string"==typeof t}C(r)&&(r=i.querySelectorAll(r)),0===r.length&&console.warn("No elements to sort");var F,N,E=i.createDocumentFragment(),A=[],q=[],M=[],k=[],D=!0,z=r.length&&r[0].parentNode,Y=z.rootNode!==document,H=r.length&&(s===a||!1!==s.useFlex)&&!Y&&-1!==getComputedStyle(z,null).display.indexOf("flex");return function(){0===arguments.length?m({}):t(arguments,function(t){m(C(t)?{selector:t}:t)}),f=k.length}.apply(n,Array.prototype.slice.call(arguments,1)),t(r,function(t,e){N?N!==t.parentNode&&(D=!1):N=t.parentNode;var r=k[0],a=r.hasFilter,o=r.selector,n=!o||a&&t.matchesSelector(o)||o&&t.querySelector(o)?q:M,s={elm:t,pos:e,posn:n.length};A.push(s),n.push(s)}),F=q.slice(0),q.sort(function(e,r){var n=0;for(0!==h&&(h=0);0===n&&f>h;){var s=k[h],i=s.ignoreDashes?c:l;if(t(u,function(t){var e=t.prepare;e&&e(s)}),s.sortFunction)n=s.sortFunction(e,r);else if("rand"==s.order)n=Math.random()<.5?1:-1;else{var p=o,v=x(e,s),m=x(r,s),w=""===v||v===a,y=""===m||m===a;if(v===m)n=0;else if(s.emptyEnd&&(w||y))n=w&&y?0:w?1:-1;else{if(!s.forceStrings){var S=C(v)?v&&v.match(i):o,F=C(m)?m&&m.match(i):o;S&&F&&v.substr(0,v.length-S[0].length)==m.substr(0,m.length-F[0].length)&&(p=!o,v=d(S[0]),m=d(F[0]))}n=v===a||m===a?0:s.natural&&(isNaN(v)||isNaN(m))?g(v,m,b):m>v?-1:v>m?1:0}}t(u,function(t){var e=t.sort;e&&(n=e(s,p,v,m,n))}),0==(n*=s.sortReturnNumber)&&h++}return 0===n&&(n=e.pos>r.pos?1:-1),n}),function(){var t=q.length===A.length;if(D&&t)H?q.forEach(function(t,e){t.elm.style.order=e}):N?N.appendChild(w()):console.warn("parentNode has been removed");else{var e=k[0].place,r="start"===e,a="end"===e,o="first"===e,n="last"===e;if("org"===e)q.forEach(y),q.forEach(function(t,e){S(F[e],t.elm)});else if(r||a){var s=F[r?0:F.length-1],i=s&&s.elm.parentNode,d=i&&(r&&i.firstChild||i.lastChild);d&&(d!==s.elm&&(s={elm:d}),y(s),a&&i.appendChild(s.ghost),S(s,w()))}else(o||n)&&S(y(F[o?0:F.length-1]),w())}}(),q.map(function(t){return t.elm})},{plugin:r,defaults:v})}()),function(t,e){"function"==typeof define&&define.amd?define(["jquery","tinysort","moment"],e):e(t.jQuery,t.tinysort,t.moment||void 0)}(this,function(t,e,r){function a(e){var a=void 0!==r;u=e.sign?e.sign:"arrow","default"==e.customSort&&(e.customSort=d),f=e.customSort||f||d,h=e.emptyEnd,t("table.sortable").each(function(){var o=t(this),n=!0===e.applyLast;o.find("span.sign").remove(),o.find("> thead [colspan]").each(function(){for(var e=parseFloat(t(this).attr("colspan")),r=1;r<e;r++)t(this).after('<th class="colspan-compensate">')}),o.find("> thead [rowspan]").each(function(){for(var e=t(this),r=parseFloat(e.attr("rowspan")),a=1;a<r;a++){var o=e.parent("tr"),n=o.next("tr"),s=o.children().index(e);n.children().eq(s).before('<th class="rowspan-compensate">')}}),o.find("> thead tr").each(function(e){t(this).find("th").each(function(r){var a=t(this);a.addClass("nosort").removeClass("up down"),a.attr("data-sortcolumn",r),a.attr("data-sortkey",r+"-"+e)})}),o.find("> thead .rowspan-compensate, .colspan-compensate").remove(),o.find("th").each(function(){var e=t(this);if(void 0!==e.attr("data-dateformat")&&a){n=parseFloat(e.attr("data-sortcolumn"));o.find("td:nth-child("+(n+1)+")").each(function(){var a=t(this);a.attr("data-value",r(a.text(),e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss"))})}else if(void 0!==e.attr("data-valueprovider")){var n=parseFloat(e.attr("data-sortcolumn"));o.find("td:nth-child("+(n+1)+")").each(function(){var r=t(this);r.attr("data-value",new RegExp(e.attr("data-valueprovider")).exec(r.text())[0])})}}),o.find("td").each(function(){var e=t(this);void 0!==e.attr("data-dateformat")&&a?e.attr("data-value",r(e.text(),e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0!==e.attr("data-valueprovider")?e.attr("data-value",new RegExp(e.attr("data-valueprovider")).exec(e.text())[0]):void 0===e.attr("data-value")&&e.attr("data-value",e.text())});var s=i(o),d=s.bsSort;o.find('> thead th[data-defaultsort!="disabled"]').each(function(e){var r=t(this),a=r.closest("table.sortable");r.data("sortTable",a);var o=r.attr("data-sortkey"),i=n?s.lastSort:-1;d[o]=n?d[o]:r.attr("data-defaultsort"),void 0!==d[o]&&n===(o===i)&&(d[o]="asc"===d[o]?"desc":"asc",l(r,a))})})}function o(e){e.find("> tbody [rowspan-group]").each(function(){for(var e=t(this),r=e.attr("rowspan-group"),a=e.parent("tr"),o=a.children().index(e);;){var n=a.next("tr");if(!n.is("tr"))break;var s=n.children().eq(o);if(s.attr("rowspan-group")!==r)break;var i=parseFloat(e.attr("rowspan"))||1;e.attr("rowspan",i+1),s.remove(),a=n}})}function n(e){e.find("> tbody [rowspan]").each(function(){var e=t(this),r=parseFloat(e.attr("rowspan"));e.removeAttr("rowspan");var a=e.attr("rowspan-group")||c();e.attr("rowspan-group",a),e.attr("rowspan-value",r);for(var o=e.parent("tr"),n=o.children().index(e),s=1;s<r;s++){var i=e.clone(!1),d=o.next("tr");d.children().eq(n).before(i),o=d}})}function s(e){var r=t(e);l(r,r.data("sortTable")||r.closest("table.sortable"))}function i(e){var r=e.data("bootstrap-sortable-context");return void 0===r&&(r={bsSort:[],lastSort:void 0},e.find('> thead th[data-defaultsort!="disabled"]').each(function(e){var a=t(this),o=a.attr("data-sortkey");r.bsSort[o]=a.attr("data-defaultsort"),void 0!==r.bsSort[o]&&(r.lastSort=o)}),e.data("bootstrap-sortable-context",r)),r}function d(t,r){e(t,r)}function l(e,r){r.trigger("before-sort"),n(r);var a=parseFloat(e.attr("data-sortcolumn")),s=i(r),d=s.bsSort;if(e.attr("colspan")){var c=parseFloat(e.data("mainsort"))||0,p=parseFloat(e.data("sortkey").split("-").pop());if(r.find("> thead tr").length-1>p)return void l(r.find('[data-sortkey="'+(a+c)+"-"+(p+1)+'"]'),r);a+=c}var v=e.attr("data-defaultsign")||u;if(r.find("> thead th").each(function(){t(this).removeClass("up").removeClass("down").addClass("nosort")}),t.browser.mozilla){var m=r.find("> thead div.mozilla");void 0!==m&&(m.find(".sign").remove(),m.parent().html(m.html())),e.wrapInner('<div class="mozilla"></div>'),e.children().eq(0).append('<span class="sign '+v+'"></span>')}else r.find("> thead span.sign").remove(),e.append('<span class="sign '+v+'"></span>');var g=e.attr("data-sortkey"),b="desc"!==e.attr("data-firstsort")?"desc":"asc",w=d[g]||b;s.lastSort!==g&&void 0!==d[g]||(w="asc"===w?"desc":"asc"),d[g]=w,s.lastSort=g,"desc"===d[g]?(e.find("span.sign").addClass("up"),e.addClass("up").removeClass("down nosort")):e.addClass("down").removeClass("up nosort");var y=r.children("tbody").children("tr"),S=[];t(y.filter('[data-disablesort="true"]').get().reverse()).each(function(e,r){var a=t(r);S.push({index:y.index(a),row:a}),a.remove()});var x=y.not('[data-disablesort="true"]');if(0!=x.length){var C="asc"===d[g]&&h;f(x,{emptyEnd:C,selector:"td:nth-child("+(a+1)+")",order:d[g],data:"value"})}t(S.reverse()).each(function(t,e){0===e.index?r.children("tbody").prepend(e.row):r.children("tbody").children("tr").eq(e.index-1).after(e.row)}),r.find("> tbody > tr > td.sorted,> thead th.sorted").removeClass("sorted"),x.find("td:eq("+a+")").addClass("sorted"),e.addClass("sorted"),o(r),r.trigger("sorted")}function c(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var u,f,h,p=t(document);if(t.bootstrapSortable=function(t){void 0==t?a({}):t.constructor===Boolean?a({applyLast:t}):void 0!==t.sortingHeader?s(t.sortingHeader):a(t)},p.on("click",'table.sortable>thead th[data-defaultsort!="disabled"]',function(t){s(this)}),!t.browser){t.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var v=navigator.userAgent;t.each(t.browser,function(e){t.browser[e]=!!new RegExp(e,"i").test(v),t.browser.mozilla&&"mozilla"===e&&(t.browser.mozilla=!!new RegExp("firefox","i").test(v)),t.browser.chrome&&"safari"===e&&(t.browser.safari=!1)})}t(t.bootstrapSortable)});